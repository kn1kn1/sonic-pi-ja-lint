{"version":3,"sources":["../src/1.1.3.js"],"names":[],"mappings":"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","file":"1.1.3.js","sourcesContent":["// LICENSE : MIT\n\"use strict\";\n/*\n1.1.3.箇条書き\n\n基本的に本文の文体に合わせます。\nただし、本文が「敬体」である場合、箇条書きに「常体」または「体言止め」も使う場合があります。\n一般読者向け の文書で、本文が敬体である場合、多くの場合、箇条書きでも敬体を使います。\n本文が「常体」である場合、箇条書きには「常体」または「体言止め」を使います。「敬体」は使いません。\nいずれの場合も、ひとまとまりの箇条書きでは、敬体と常体を混在させません。文末に句点(。)を付けるかどうかも統一します。\n */\nimport {analyzeDesumasu, analyzeDearu} from \"analyze-desumasu-dearu\";\nexport default function (context) {\n    let {Syntax, RuleError, report, getSource} = context;\n    let desumasuList = [];\n    let dearuList = [];\n    // 。付きのListItem\n    let withPointList = [];\n    // 。なしのListItem\n    let withoutPointList = [];\n    \n    function resetList() {\n        dearuList = [];\n        desumasuList = [];\n        withPointList = [];\n        withoutPointList = [];\n    }\n    \n    function reportPointResult(nodeList, {shouldUsePoint}) {\n        nodeList.forEach(node => {\n            let message;\n            if (shouldUsePoint) {\n                message = `箇条書きの文末に句点(。)を付けて下さい。\\n箇条書きの文末に句点(。)を付けるかを統一します。`\n            } else {\n                message = `箇条書きの文末から句点(。)を外して下さい。\\n箇条書きの文末に句点(。)を付けるかを統一します。`\n            }\n            report(node, new RuleError(message));\n        });\n    }\n    \n    function reportDesumaruDearuResult(list, {desumasu,dearu}) {\n        list.forEach(({node, matches}) => {\n            matches.forEach(match => {\n                let message;\n                if (desumasu) {\n                    message = `箇条書きを敬体(ですます調)に統一して下さい。\\nひとまとまりの箇条書きでは、敬体と常体を混在させません。\\n\"${match.value}\"が常体(である調)です。`\n                } else if (dearu) {\n                    message = `箇条書きを常体(である調)に統一して下さい。\\nひとまとまりの箇条書きでは、敬体と常体を混在させません。\\n\"${match.value}\"が敬体(ですます調)です。`\n                }\n                report(node, new RuleError(message, {\n                    line: match.lineNumber - 1,\n                    column: match.columnIndex\n                }));\n            });\n        });\n    }\n\n    // 末尾に。があるかが統一されているのチェック\n    function countingPoint(withPointList, withoutPointList) {\n        if (withPointList.length === 0 || withoutPointList.length === 0) {\n            return;\n        }\n        if (withPointList.length > withoutPointList.length) {\n            // 。ありに統一\n            reportPointResult(withoutPointList, {\n                shouldUsePoint: true\n            });\n        } else if (withPointList.length < withoutPointList.length) {\n            // 。なしに統一\n            reportPointResult(withPointList, {\n                shouldUsePoint: false\n            });\n        } else {\n            // 。ありに統一\n            reportPointResult(withoutPointList, {\n                shouldUsePoint: true\n            });\n        }\n    }\n\n    // 敬体(ですます調)あるいは常体(である調)なのかのチェック\n    function countingDesumasuDearu(desumasuList, dearuList) {\n        let desumasuCount = desumasuList.reduce((count, {matches}) => count + matches.length, 0);\n        let dearuCount = dearuList.reduce((count, {matches}) => count + matches.length, 0);\n        if (desumasuCount === 0 || dearuCount === 0) {\n            return;\n        }\n        // ですます優先\n        if (desumasuCount > dearuCount) {\n            reportDesumaruDearuResult(dearuList, {\n                desumasu: true\n            });\n        } else if (desumasuCount < dearuCount) {\n            // である優先\n            reportDesumaruDearuResult(desumasuList, {\n                dearu: true\n            });\n        } else {\n            // 同等の場合はですます優先\n            reportDesumaruDearuResult(dearuList, {\n                desumasu: true\n            });\n        }\n    }\n    \n    return {\n        [Syntax.List](node){\n            resetList()\n        },\n        [Syntax.ListItem](node){\n            let text = getSource(node);\n            // 末尾に。があるかが統一されているのチェック\n            let matchPointReg = /。(\\s*?)$/;\n            if (matchPointReg.test(text)) {\n                // 。あり\n                withPointList.push(node);\n            } else {\n                // 。なし\n                withoutPointList.push(node);\n            }\n            // 敬体(ですます調)あるいは常体(である調)なのかのチェック\n            let retDesumasu = analyzeDesumasu(text);\n            if (retDesumasu.length > 0) {\n                desumasuList.push({\n                    node: node,\n                    matches: retDesumasu\n                });\n            }\n            let retDearu = analyzeDearu(text);\n            if (retDearu.length > 0) {\n                dearuList.push({\n                    node: node,\n                    matches: retDearu\n                });\n            }\n        },\n        [`${Syntax.List}:exit`](node){\n            countingPoint(withPointList, withoutPointList);\n            \n            countingDesumasuDearu(desumasuList, dearuList);\n        }\n    }\n}"]}