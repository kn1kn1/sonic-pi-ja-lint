{"version":3,"sources":["../../src/config/config.js"],"names":["objectAssign","require","md5","fs","assert","pkg","concat","path","convertRulesConfigToFlatPath","rulesConfig","filteredConfig","Object","keys","forEach","key","defaultOptions","freeze","rules","disabledRules","filterRules","disabledFilterRules","filterRulesConfig","presets","plugins","rulesBaseDirectory","undefined","configFile","rulePaths","extensions","formatterName","color","cache","cacheLocation","resolve","process","cwd","Config","version","toString","JSON","stringify","toJSON","cliOptions","options","ext","rule","preset","plugin","config","rulesdir","format","initWithAutoLoading","moduleResolver","configFileRawOptions","configFileName","CONFIG_FILE_NAME","configRulesObject","configFilterRulesObject","filters","configPresets","configFilePlugins","configFileRulesConfig","configFileFilterRulesConfig","optionRules","optionFilterRules","optionDisbaledRules","optionDisbaledFilterRules","optionRulesConfig","optionFilterRulesConfig","optionPlugins","optionPresets","available","disable","mergedOptions","constructor","pluginRulesConfig","presetRulesConfig","additionalExtensions","_assertCacheLocation","locationPath","fileStats","lstatSync","ex","isDirectory","r","create","hasOwnProperty","value","module","exports"],"mappings":"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","file":"config.js","sourcesContent":["// LICENSE : MIT\n\"use strict\";\nconst objectAssign = require(\"object-assign\");\nconst md5 = require(\"md5\");\nconst fs = require(\"fs\");\nconst assert = require(\"assert\");\nconst pkg = require(\"../../package.json\");\nconst concat = require(\"unique-concat\");\nconst path = require(\"path\");\nimport loadConfig from \"./config-loader\";\nimport {isPresetRuleKey} from \"../util/config-util\";\nimport {mapRulesConfig} from \"./preset-loader\";\nimport {\n    loadRulesConfig as loadRulesConfigFromPlugins,\n    loadAvailableExtensions\n} from \"./plugin-loader\";\nimport loadRulesConfigFromPresets from \"./preset-loader\";\nimport TextLintModuleResolver from \"../engine/textlint-module-resolver\";\nimport separateAvailableOrDisable from \"./separate-by-config-option\";\n/**\n * Convert config of preset to rulesConfig flat path format.\n *\n * e.g.)\n * {\n *  \"preset-a\" : { \"key\": \"value\"}\n * }\n * => {\"preset-a/key\": \"value\"}\n *\n * @param rulesConfig\n * @returns {{string: string}}\n */\nfunction convertRulesConfigToFlatPath(rulesConfig) {\n    if (!rulesConfig) {\n        return {};\n    }\n    const filteredConfig = {};\n    Object.keys(rulesConfig).forEach(key => {\n        if (isPresetRuleKey(key)) {\n            // <preset>/<rule>\n            objectAssign(filteredConfig, mapRulesConfig(rulesConfig[key], key));\n            return;\n        }\n        filteredConfig[key] = rulesConfig[key];\n    });\n    return filteredConfig;\n}\n/**\n * @type {TextLintConfig}\n */\nconst defaultOptions = Object.freeze({\n    // rule package names\n    rules: [],\n    // disabled rule package names\n    // always should start with empty\n    disabledRules: [],\n    // rules config object\n    rulesConfig: {},\n    // filter rule package names\n    filterRules: [],\n    disabledFilterRules: [],\n    // rules config object\n    filterRulesConfig: {},\n    // preset package names\n    // e.g.) [\"preset-foo\"]\n    presets: [],\n    // plugin package names\n    plugins: [],\n    // base directory for loading {rule, config, plugin} modules\n    rulesBaseDirectory: undefined,\n    // \".textlint\" file path\n    configFile: undefined,\n    // rule directories\n    rulePaths: [],\n    // available extensions\n    // if set the option, should filter by extension.\n    extensions: [],\n    // formatter file name\n    // e.g.) stylish.js => set \"stylish\"\n    // NOTE: default formatter is defined in Engine,\n    // because There is difference between TextLintEngine and TextFixEngine.\n    formatterName: undefined,\n    // --no-color\n    color: true,\n    // --cache : enable or disable\n    cache: false,\n    // --cache-location: cache file path\n    cacheLocation: path.resolve(process.cwd(), \".textlintcache\")\n});\n\n// Priority: CLI > Code options > config file\nclass Config {\n    /**\n     * @return {string} rc config filename\n     * it's name use as `.<name>rc`\n     */\n    static get CONFIG_FILE_NAME() {\n        return \"textlint\";\n    }\n\n    /**\n     * @return {string} config package prefix\n     */\n    static get CONFIG_PACKAGE_PREFIX() {\n        return \"textlint-config-\";\n    }\n\n    /**\n     * @return {string} rule package's name prefix\n     */\n    static get RULE_NAME_PREFIX() {\n        return \"textlint-rule-\";\n    }\n\n    /**\n     * @return {string} filter rule package's name prefix\n     */\n    static get FILTER_RULE_NAME_PREFIX() {\n        return \"textlint-filter-rule-\";\n    }\n\n    /**\n     * @return {string} rule preset package's name prefix\n     */\n    static get RULE_PRESET_NAME_PREFIX() {\n        return \"textlint-rule-preset-\";\n    }\n\n    /**\n     * @return {string} plugins package's name prefix\n     */\n    static get PLUGIN_NAME_PREFIX() {\n        return \"textlint-plugin-\";\n    }\n\n    /**\n     * Create config object form command line options\n     * See options.js\n     * @param {object} cliOptions the options is command line option object. @see options.js\n     * @returns {Config}\n     */\n    static initWithCLIOptions(cliOptions) {\n        const options = {};\n        options.extensions = cliOptions.ext ? cliOptions.ext : defaultOptions.extensions;\n        options.rules = cliOptions.rule ? cliOptions.rule : defaultOptions.rules;\n        // TODO: CLI --filter <rule>?\n        options.filterRules = defaultOptions.filterRules;\n        options.disabledFilterRules = defaultOptions.disabledFilterRules;\n        // TODO: CLI --disable <rule>?\n        options.disabledRules = defaultOptions.disabledRules;\n        options.presets = cliOptions.preset ? cliOptions.preset : defaultOptions.presets;\n        options.plugins = cliOptions.plugin ? cliOptions.plugin : defaultOptions.plugins;\n        options.configFile = cliOptions.config ? cliOptions.config : defaultOptions.configFile;\n        options.rulePaths = cliOptions.rulesdir ? cliOptions.rulesdir : defaultOptions.rulePaths;\n        options.formatterName = cliOptions.format ? cliOptions.format : defaultOptions.formatterName;\n        options.color = cliOptions.color !== undefined ? cliOptions.color : defaultOptions.color;\n        // --cache\n        options.cache = cliOptions.cache !== undefined ? cliOptions.cache : defaultOptions.cache;\n        // --cache-location=\"path/to/file\"\n        options.cacheLocation = cliOptions.cacheLocation !== undefined\n            ? path.resolve(process.cwd(), cliOptions.cacheLocation)\n            : defaultOptions.cacheLocation;\n        return this.initWithAutoLoading(options);\n    }\n\n    /* eslint-disable complexity */\n    // load config and merge options.\n    static initWithAutoLoading(options = {}) {\n        // Base directory\n        const rulesBaseDirectory = options.rulesBaseDirectory\n            ? options.rulesBaseDirectory\n            : defaultOptions.rulesBaseDirectory;\n        // Create resolver\n        const moduleResolver = new TextLintModuleResolver(this, rulesBaseDirectory);\n        // => ConfigFile\n        // configFile is optional\n        // => load .textlintrc\n        const configFileRawOptions = loadConfig(options.configFile, {\n                moduleResolver,\n                configFileName: this.CONFIG_FILE_NAME\n            }) || {};\n        // \"rules\" field is here!\n        const configRulesObject = separateAvailableOrDisable(configFileRawOptions.rules);\n        // \"filters\" field is here!\n        const configFilterRulesObject = separateAvailableOrDisable(configFileRawOptions.filters);\n        const configPresets = configRulesObject.presets;\n        const configFilePlugins = configFileRawOptions.plugins || [];\n        const configFileRulesConfig = convertRulesConfigToFlatPath(configFileRawOptions.rules);\n        const configFileFilterRulesConfig = convertRulesConfigToFlatPath(configFileRawOptions.filters);\n        // => Options\n        const optionRules = options.rules || [];\n        const optionFilterRules = options.filterRules || [];\n        const optionDisbaledRules = options.disabledRules || [];\n        const optionDisbaledFilterRules = options.disabledFilterRules || [];\n        const optionRulesConfig = options.rulesConfig || {};\n        const optionFilterRulesConfig = options.filterRulesConfig || {};\n        const optionPlugins = options.plugins || [];\n        const optionPresets = options.presets || [];\n        // => Merge options and configFileOptions\n        // Priority options > configFile\n        const rules = concat(optionRules, configRulesObject.available);\n        const disabledRules = concat(optionDisbaledRules, configRulesObject.disable);\n        const filterRules = concat(optionFilterRules, configFilterRulesObject.available);\n        const disabledFilterRules = concat(optionDisbaledFilterRules, configFilterRulesObject.disable);\n        const rulesConfig = objectAssign({}, configFileRulesConfig, optionRulesConfig);\n        const filterRulesConfig = objectAssign({}, configFileFilterRulesConfig, optionFilterRulesConfig);\n        const plugins = concat(optionPlugins, configFilePlugins);\n        const presets = concat(optionPresets, configPresets);\n        const mergedOptions = objectAssign({}, options, {\n            rules,\n            disabledRules,\n            rulesConfig,\n            filterRules,\n            disabledFilterRules,\n            filterRulesConfig,\n            plugins,\n            presets\n        });\n        return new this(mergedOptions);\n    }\n\n\n    /**\n     * Return hash string of the config and textlint version\n     * @returns {string}\n     */\n    get hash() {\n        const version = pkg.version;\n        const toString = JSON.stringify(this.toJSON());\n        return md5(`${version}-${toString}`);\n    }\n\n    /**\n     * initialize with options.\n     * @param {TextLintConfig} options the option object is defined as TextLintConfig.\n     * @returns {Config}\n     * @constructor\n     */\n    constructor(options = {}) {\n        /**\n         * @type {string|null} path to .textlintrc file.\n         */\n        this.configFile = options.configFile;\n        this.rulesBaseDirectory = options.rulesBaseDirectory\n            ? options.rulesBaseDirectory\n            : defaultOptions.rulesBaseDirectory;\n        // rule names that are defined in ,textlintrc\n        const moduleResolver = new TextLintModuleResolver(this.constructor, this.rulesBaseDirectory);\n        /**\n         * @type {string[]} rule key list\n         * but, plugins's rules are not contained in `rules`\n         * plugins's rule are loaded in TextLintEngine\n         */\n        this.rules = options.rules ? options.rules : defaultOptions.rules;\n        /**\n         * @type {string[]} rule key list\n         * These rule is set `false` to options\n         */\n        this.disabledRules = options.disabledRules ? options.disabledRules : defaultOptions.disabledRules;\n        /**\n         * @type {string[]} filter rule key list\n         */\n        this.filterRules = options.filterRules ? options.filterRules : defaultOptions.filterRules;\n        /**\n         * @type {string[]} rule key list\n         * These rule is set `false` to options\n         */\n        this.disabledFilterRules = options.disabledFilterRules ? options.disabledFilterRules\n            : defaultOptions.disabledFilterRules;\n        /**\n         * @type {string[]} preset key list\n         */\n        this.presets = options.presets ? options.presets : defaultOptions.presets;\n        // => load plugins\n        // this.rules has not contain plugin rules\n        // =====================\n        this.plugins = options.plugins ? options.plugins : defaultOptions.plugins;\n        // rulesConfig\n        const pluginRulesConfig = loadRulesConfigFromPlugins(this.plugins, moduleResolver);\n        const presetRulesConfig = loadRulesConfigFromPresets(this.presets, moduleResolver);\n        this.rulesConfig = objectAssign({}, presetRulesConfig, pluginRulesConfig, options.rulesConfig);\n\n        // filterRulesConfig\n        this.filterRulesConfig = options.filterRulesConfig || defaultOptions.filterRulesConfig;\n        /**\n         * @type {string[]}\n         */\n        this.extensions = options.extensions ? options.extensions : defaultOptions.extensions;\n        // additional availableExtensions from plugin\n        const additionalExtensions = loadAvailableExtensions(this.plugins, moduleResolver);\n        this.extensions = this.extensions.concat(additionalExtensions);\n        /**\n         * @type {string[]}\n         */\n        this.rulePaths = options.rulePaths ? options.rulePaths : defaultOptions.rulePaths;\n        /**\n         * @type {string}\n         */\n        this.formatterName = options.formatterName ? options.formatterName : defaultOptions.formatterName;\n        /**\n         * @type {boolean}\n         */\n        this.color = options.color !== undefined ? options.color : defaultOptions.color;\n        /**\n         * @type {boolean}\n         */\n        this.cache = options.cache !== undefined ? options.cache : defaultOptions.cache;\n        /**\n         * @type {string}\n         */\n        this.cacheLocation = options.cacheLocation !== undefined ? options.cacheLocation : defaultOptions.cacheLocation;\n        this._assertCacheLocation(this.cacheLocation);\n    }\n\n\n    _assertCacheLocation(locationPath) {\n        let fileStats;\n        try {\n            fileStats = fs.lstatSync(locationPath);\n        } catch (ex) {\n            fileStats = null;\n        }\n        if (!fileStats) {\n            return;\n        }\n        // TODO: --cache-location not supported directory\n        // We should defined what is default name.\n        assert(!fileStats.isDirectory(), \"--cache-location doesn't support directory\");\n    }\n\n    /* eslint-enable complexity */\n\n    toJSON() {\n        const r = Object.create(null);\n        Object.keys(this).forEach(key => {\n            if (!this.hasOwnProperty(key)) {\n                return;\n            }\n            const value = this[key];\n            if (value == null) {\n                return;\n            }\n            r[key] = typeof value.toJSON !== \"undefined\" ? value.toJSON() : value;\n        });\n        return r;\n    }\n}\nmodule.exports = Config;\n"]}